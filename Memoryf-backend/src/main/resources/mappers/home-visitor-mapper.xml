<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="homeVisitorMapper">

    <!-- 오늘 방문 여부 -->
    <select id="existsToday" resultType="int">
        SELECT COUNT(*)
        FROM TB_HOME_VISITOR
        WHERE MEMBER_NO = #{memberNo}
          AND HOME_NO = #{homeNo}
          AND TRUNC(VISIT_DATE) = TRUNC(SYSDATE)
    </select>

    <!-- 방문 기록 저장 -->
    <insert id="insertVisit">
        INSERT INTO TB_HOME_VISITOR (
            VISITOR_NO,
            MEMBER_NO,
            HOME_NO,
            VISIT_DATE
        ) VALUES (
            SEQ_VISITOR_NO.NEXTVAL,
            #{memberNo},
            #{homeNo},
            SYSDATE
        )
    </insert>

    <!-- 오늘 방문자 수 -->
    <select id="selectTodayCount" resultType="int">
        SELECT COUNT(*)
        FROM TB_HOME_VISITOR
        WHERE HOME_NO = #{homeNo}
          AND TRUNC(VISIT_DATE) = TRUNC(SYSDATE)
    </select>

    <!-- 전체 방문자 수 -->
    <select id="selectTotalCount" resultType="int">
        SELECT COUNT(*)
        FROM TB_HOME_VISITOR
        WHERE HOME_NO = #{homeNo}
    </select>

</mapper>
